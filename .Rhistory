# cache results
# knitr::opts_chunk$set(cache=TRUE, echo = FALSE, eval = FALSE, message=FALSE, warning = FALSE, fig.align='center')
# ...
library(tidyr)
# ...
library(dplyr)
# library to read the excell file
library(readxl)
# ...
library(tidyr)
# ...
library(dplyr)
# read excell dataset
raw_avengers <- read_excel("my_file.xlsx")
# read excell dataset
raw_avengers <- read_excel("Avengers.xlsx")
View(raw_avengers)
# library to read the excell file
library(readxl)
# ...
library(tidyr)
# ...
library(dplyr)
# read all the sheets
# https://stackoverflow.com/a/12945838
read_excel_allsheets <- function(filename, tibble = TRUE) {
# I prefer straight data.frames
# but if you like tidyverse tibbles (the default with read_excel)
# then just pass tibble = TRUE
sheets <- readxl::excel_sheets(filename)
x <- lapply(sheets, function(X) readxl::read_excel(filename, sheet = X))
if(!tibble) x <- lapply(x, as.data.frame)
names(x) <- sheets
return(x)
}
# read excell dataset
raw_avengers <- read_excel_allsheets("Avengers.xlsx")
# read excell dataset
raw_avengers <- read_excel_allsheets("Avengers.xlsx")
raw_avengers
typeof(raw_avengers)
# read excell dataset
raw_avengers <- read_excel_allsheets("Avengers.xlsx")
tibble(raw_avengers)
# turn the
raw_avengers_one <- tibble()
# read excell dataset
# (now I have a list of tibbles)
raw_avengers <- read_excel_allsheets("Avengers.xlsx")
# turn the
raw_avengers_one <- tibble()
i <- 0
for(sheetname in names(raw_avengers)) {
# get the sheet
sheet <- raw_avengers[[sheetname]]
# add incremental id
sheet <- sheet %>%
mutate(
id = row_number() + i,
movie = sheetname,
)
# increment the id with the numbers
i <- i + count(sheet)
# attach the sheet
raw_avengers_one <- raw_avengers_one %>%
bind_rows(sheet)
}
# read excell dataset
# (now I have a list of tibbles)
raw_avengers <- read_excel_allsheets("Avengers.xlsx")
enframe(raw_avengers)
as_tibble(raw_avengers)
# read excell dataset
# (now I have a list of tibbles)
raw_avengers <- read_excel_allsheets("Avengers.xlsx")
as_tibble(raw_avengers)
tibble(raw_avengers)
tibble(movie=names(raw_avengers), data=raw_avengers)
# read excell dataset
# (now I have a list of tibbles)
raw_avengers_list_of_tibble <- read_excel_allsheets("Avengers.xlsx")
raw_avengers_tibble_of_tibble <- tibble(movie=names(raw_avengers), data=raw_avengers)
View(raw_avengers_tibble_of_tibble)
# read excell dataset
# (now I have a list of tibbles)
raw_avengers_list_of_tibble <- read_excel_allsheets("Avengers.xlsx")
raw_avengers_tibble_of_tibble <- tibble(movie=names(raw_avengers), data=raw_avengers)
View(raw_avengers_tibble_of_tibble)
